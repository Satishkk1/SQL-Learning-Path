--Self Join Table: From a given table of list of employees and their salary, identify their managers salary and 
  also create a new field where employees with salary more than their Manager--

--INPUT TABLE--
create table emp(emp_id int,emp_name varchar(10),salary int ,manager_id int);

insert into emp values(1,'Ankit',10000,4);
insert into emp values(2,'Mohit',15000,5);
insert into emp values(3,'Vikas',10000,4);
insert into emp values(4,'Rohit',5000,2);
insert into emp values(5,'Mudit',12000,6);
insert into emp values(6,'Agam',12000,2);
insert into emp values(7,'Sanjay',9000,2);
insert into emp values(8,'Ashish',5000,2);

select * from emp;


--SOLUTION TABLE--
select 
a.*,
b.emp_name as Manager_Name,
b.salary as Manager_Salary,
Case when a.salary > b.Salary then 'High' else 'Low' end as Salary_mkr
from emp as a
left join emp as b on a.manager_id = b.emp_id
Order by emp_id;
